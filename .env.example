# ═══════════════════════════════════════════════════════════════════════
# Stride OS / Dreamy — Environment Variables
# ═══════════════════════════════════════════════════════════════════════
# Copy this file to .env.local and fill in real values.
#   cp .env.example .env.local
#
# Variables prefixed with NEXT_PUBLIC_ are exposed to the browser.
# All other variables are server-only.
# ═══════════════════════════════════════════════════════════════════════


# ═══════════════════════════════════════
# Database
# ═══════════════════════════════════════

# Neon Postgres connection string (production / Vercel deployment)
# The app uses SQLite locally (./data/stride.db) and Postgres in production.
# If DATABASE_URL is set, the app connects to Postgres; otherwise it falls back to SQLite.
# Providers: Neon, Supabase, Vercel Postgres, or any Postgres host.
# DATABASE_URL=postgresql://user:password@host/dbname?sslmode=require


# ═══════════════════════════════════════
# Strava Integration
# ═══════════════════════════════════════

# Strava API application credentials (https://www.strava.com/settings/api)
# NEXT_PUBLIC_STRAVA_CLIENT_ID is exposed to the browser for the OAuth flow.
NEXT_PUBLIC_STRAVA_CLIENT_ID=your_strava_client_id
STRAVA_CLIENT_SECRET=your_strava_client_secret

# Alternative server-only client ID (optional, falls back to NEXT_PUBLIC_ version)
# STRAVA_CLIENT_ID=your_strava_client_id

# Webhook verification token — must match what you register with Strava.
# Used by GET /api/strava/webhook to verify subscription requests.
STRAVA_WEBHOOK_VERIFY_TOKEN=your_strava_webhook_verify_token

# Override the webhook callback URL (optional, defaults to {NEXT_PUBLIC_APP_URL}/api/strava/webhook)
# STRAVA_WEBHOOK_CALLBACK_URL=https://www.getdreamy.run/api/strava/webhook

# Manual Strava token setup (scripts only — used by scripts/setup-strava-tokens.ts)
# These are NOT needed for normal OAuth flow; only for bootstrapping tokens via CLI.
# STRAVA_ACCESS_TOKEN=your_strava_access_token
# STRAVA_REFRESH_TOKEN=your_strava_refresh_token
# STRAVA_TOKEN_EXPIRES_AT=1700000000


# ═══════════════════════════════════════
# AI / LLM
# ═══════════════════════════════════════

# Anthropic API key — powers the AI running coach (Claude).
# Get yours at https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-your-key-here

# OpenAI API key — optional, used for alternative model routing (training plan generation).
# Get yours at https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-your-openai-key-here


# ═══════════════════════════════════════
# Authentication — Role-Based Gate
# ═══════════════════════════════════════

# The gate (/gate) protects non-localhost deployments.
# Each role has independent credentials. Leave a password blank to disable that role.

# Admin — full access to all routes including /admin and /api/admin/*
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_admin_password

# User — full access except admin-only surfaces
USER_USERNAME=user
USER_PASSWORD=your_user_password

# Viewer — read-only access (can browse data + use chat, cannot mutate)
VIEWER_USERNAME=viewer
VIEWER_PASSWORD=your_viewer_password

# Coach — read-only access similar to viewer (intended for sharing with a coach)
COACH_USERNAME=coach
COACH_PASSWORD=your_coach_password

# Legacy simple password gate (optional — ADMIN_PASSWORD takes precedence)
# SITE_PASSWORD=your_site_password

# Admin secret — required header (x-admin-secret) for /api/admin/* endpoints,
# cron jobs, export API, and profile management. Keep this strong.
ADMIN_SECRET=your_admin_secret_here


# ═══════════════════════════════════════
# External Services
# ═══════════════════════════════════════

# Canonical app URL — used for Strava OAuth redirect URIs and link generation.
# Set this to your production domain. Vercel sets NEXT_PUBLIC_BASE_URL automatically.
# NEXT_PUBLIC_APP_URL=https://www.getdreamy.run

# Fallback base URL (auto-set by Vercel, usually not needed manually)
# NEXT_PUBLIC_BASE_URL=https://your-app.vercel.app

# Vercel cron secret — sent as Authorization: Bearer <token> by Vercel Cron Jobs.
# Used by /api/cron/strava-sync and /api/cron/strava-kudos.
# CRON_SECRET=your_vercel_cron_secret

# Contact email shown on the forgot-password flow (/api/gate/forgot)
# PASSWORD_RESET_CONTACT_EMAIL=you@example.com

# Fallback support email (used if PASSWORD_RESET_CONTACT_EMAIL is not set)
# SUPPORT_EMAIL=support@example.com

# Token encryption key — AES-256-GCM key for encrypting Strava OAuth tokens at rest.
# 32 bytes = 64 hex characters. Generate with:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# If not set, tokens are stored in plaintext (acceptable for local dev only).
# TOKEN_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# Secret key for the seed-demo API endpoint (/api/seed-demo?key=<value>)
# Only needed if you use the demo seeding route.
# SEED_SECRET_KEY=your_seed_secret


# ═══════════════════════════════════════
# Feature Flags / Access Modes
# ═══════════════════════════════════════

# App view mode — controls how the app behaves for unauthenticated visitors.
#   private  — normal production mode, auth gate enabled (default)
#   share    — sharing/demo mode: bypass gate, force a single profile, read-only for guests
#   publish  — published portfolio mode: gate enforced but public-facing features enabled
# APP_VIEW_MODE=private
# NEXT_PUBLIC_APP_VIEW_MODE=private

# Legacy access mode flag (still supported; maps "public" -> "share")
# APP_ACCESS_MODE=private
# NEXT_PUBLIC_APP_ACCESS_MODE=private

# Profile ID to use in public/share mode (defaults to 1)
# PUBLIC_PROFILE_ID=1
# NEXT_PUBLIC_PUBLIC_PROFILE_ID=1

# Legacy guest profile flags (still supported, mapped to PUBLIC_PROFILE_ID)
# GUEST_PROFILE_ID=1
# NEXT_PUBLIC_GUEST_PROFILE_ID=1

# Legacy flag to enable guest full access (maps to share mode)
# ENABLE_GUEST_FULL_ACCESS=false
# NEXT_PUBLIC_ENABLE_GUEST_FULL_ACCESS=false
